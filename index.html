<!--本程序由Billraozihan写成，绝大部分样式来自MDUI。作者邮箱：907222638@qq.com -->
<!DOCTYPE html>
<html lang="zh">
	<head>
        <meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="referrer" content="no-referrer"><!--取消大部分的防盗链设置（使图片不受防盗链限制-->

        <META HTTP-EQUIV="pragma" CONTENT="no-cache">
        <META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
        <META HTTP-EQUIV="expires" CONTENT="0"><!--这三个是为了让网站不被缓存，文章修改没那么频繁的可以删掉-->

		<title id="title">Blog</title>
		<link rel="stylesheet" href="//cdnjs.loli.net/ajax/libs/mdui/0.4.3/css/mdui.min.css">
		<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/Billraozihan/cdn/md.css">
		<script src="//cdnjs.loli.net/ajax/libs/mdui/0.4.3/js/mdui.min.js"></script>
		<script src="//cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
		<script>
			//按照提示设置博客基本信息
			var title = "涵五记"; //标题
			var avatar = "//cdn.jsdelivr.net/gh/Billraozihan/cdn/background.jpg"; //头像链接，请使用img标签可以加载的格式。
			var name = "Billraozihan"; //博客拥有者姓名 or ID
			var solgan = "啊啊啊啊啊啊啊啊啊啊"; //博客拥有者的座右铭 or Solgan or 别的什么类似简介的文字内容，别太长
			var gov1 = "京ICP备19048465号"; //工业和信息化部的备案信息，请填写完整（X·IP备xxxxxxxx ···）
			var gov2 = "";//公网安备信息，也请填写完整
			//======================
		</script>
		<style>
			html, body {
				height: 100%;
				width: 100%;
			}
			.footer {
				width: 100%;
				padding: 20px 0;
				font-size: 0.9em;
				text-align: center;
			}
			.list {
				display: block;
				width: 100%;
				max-width: 800px;
                height: 28%;
				margin: 15px;
				/*background-color: #ccc;*/
				border-radius: 5px;
                cursor: default;
			}
			.artivalue {
                position: relative;
				margin: 15px;
				padding: 20px;
				width: 100%;
				max-width: 800px;
				height: auto;
				min-height: 80%;
				border-radius: 1em;
			}
            table{
                border:1px solid #000;
            } 
            table td{
                border:1px solid #000;
            } 
            .mdui-spinner-layer {
                border-color: white !important;
            }
		</style>
	</head>
	<body class="mdui-appbar-with-toolbar" id="body">
		<div class="mdui-appbar mdui-appbar-fixed mdui-color-theme">
			<div class="mdui-toolbar mdui-text-color-white mdui-appbar-inset">
				<button mdui-drawer="{target: '#left-drawer'}" class="mdui-btn mdui-btn-icon">
					<i class="mdui-icon material-icons"> menu </i>
				</button>
                <a href="./" class="mdui-typo-headline" id="cstitle">Blog</a>
                <div class="mdui-toolbar-spacer"></div>
                <div id="lodingO" class="mdui-spinner" style="border-color: white !important;"></div>
            </div>
		</div>

		<div class="mdui-drawer mdui-drawer-close" id="left-drawer">
			<br>
			<center>
				<img class="mdui-img-rounded mdui-img-fluid" style="max-width: 100px;" id="avatarpic">
				<div style="text-align: center;">
					<p style="margin: 10px 0 0;font-size: 1.2em;" id="authorName"></p>
					<p style="font-size: 0.7em;" id="solganValue"></p>
				</div>
				<div class="mdui-divider"></div>
			</center>
			<!--下面ul标签里的内容对应侧边栏的4项，div内的内容是文字，i内的内容是图标（不懂不要改）-->
			<ul class="mdui-list">
				<li class="mdui-list-item mdui-ripple">
					<a href="./" onclick="javascript: $index();return false;" class="mdui-list-item-content">首页</a>
					<i class="mdui-icon material-icons">&#xe88a;</i>
				</li>
				<li class="mdui-list-item mdui-ripple">
					<a href="http://file.tyatt.top/" class="mdui-list-item-content">文件共享</a>
					<i class="mdui-icon material-icons">&#xe24d;</i>
				</li>
				<li class="mdui-list-item mdui-ripple">
					<a href="http://play.tyatt.top/" class="mdui-list-item-content">好玩的</a>
					<i class="mdui-icon material-icons">&#xe338;</i>
				</li>
				<li class="mdui-list-item mdui-ripple">
					<a href="./?/About/" onclick="javascript: $Warticle('About');return false;" class="mdui-list-item-content">关于</a>
					<i class="mdui-icon material-icons">&#xe85e;</i>
				</li>
				<li class="mdui-list-item mdui-ripple">
					<!--我也不知道静态页面有什么好办法搜索博文，所以搜索功能暂定为调用百度（可自定义）搜索 "site：域名 + 关键词"，因此，站点必须被百度收录才能正常使用此功能。如果您有更好的办法（纯静态），请发邮件给我，谢谢。-->
					<div onclick="javascript:mdui.prompt('搜索', function(vlu){location.href='https:\/\/www.baidu.com/s?wd=site:'+location.hostname+'%20'+vlu;});" class="mdui-list-item-content">
						搜索
					</div>
					<i class="mdui-icon material-icons">&#xe8b6;</i>
				</li>
			</ul>
        </div>
        
        <div id="articlelist" style="width: 100%;height: auto;"></div>
        
    	<div class="footer mdui-center" id="ft">
            © Copyright 2020 - <span id = "cr"></span><!--这里的2020改成网站建立的那一年-->
            <br><br>
            Powered by TISP · Designed by Billraozihan
		    <br>
	    	<span id="beian"></span>
    		<br>
		    <span href="http://www.beian.miit.gov.cn/" onclick="javascript: location.href='http:\/\/www.beian.miit.gov.cn/';return false;" style="cursor: pointer;" id="ICP"></span>
        </div>

		<script>
            //alert(window.location.search);
			var $d = document, $ajax = new XMLHttpRequest(), $len, $json, $get = window.location.search.replace(/\?|\/?/g, ''), date = new Date();
			if ($get == "") $get = null;

			$d.getElementById('title').innerHTML = title;
			$d.getElementById('cstitle').innerHTML = title;
			$d.getElementById('avatarpic').src = avatar;
			$d.getElementById('authorName').innerHTML = name;
			$d.getElementById('solganValue').innerHTML = solgan;
			$d.getElementById('cr').innerHTML = date.getFullYear() + " " + name + ", All rights reserved."
			$d.getElementById('ICP').innerHTML = gov1;
			$d.getElementById('beian').innerHTML = gov2;

			function $index() {
                $d.getElementById('lodingO').style.display = "block";
				$ajax.open("GET", "article.json", true);
				$ajax.send(null);
				$ajax.onreadystatechange = function() {
					if ($ajax.readyState == 4 && $ajax.status == 200) {
						$json = JSON.parse($ajax.responseText);
						$len = $json.length - 1;
                        history.pushState(null, null, "/");
                        $d.getElementById('articlelist').innerHTML = "";
						for (var i = $len; i >= 0; i--) {//这里ID为articlelist的div是一个通用的放内容的div，不只是首页的文章列表
							if (!$json[i].titpiclink) {
								$d.getElementById('articlelist').innerHTML += "<div class='mdui-grid-tile mdui-center mdui-shadow-5 mdui-hoverable mdui-ripple list' style='background-color: " + $json[i].titbclr + ";height: 320px;width: 100%;max-width: 800px;'><h1 style='display: block;position: relative;top: 30%;color: " + $json[i].titfclr + ";' align='center'>" + $json[i].title + "</h1><div class='mdui-grid-tile-actions'><div class='mdui-grid-tile-text'><div class='mdui-grid-tile-title'>" + $json[i].title + "</div><div class='mdui-grid-tile-subtitle'><i class='mdui-icon material-icons'>&#xe5c3;</i>" + $json[i].cate + " , " + $json[i].time + "</div></div><div class='mdui-grid-tile-buttons'><a href='./?/" + i + "/' onclick='javascript: $Warticle(" + i + ");return false;' class='mdui-btn mdui-btn-icon'><i class='mdui-icon material-icons'>&#xe5cc;</i></a></div></div><div>";
							} else {
								$d.getElementById('articlelist').innerHTML += "<div class='mdui-grid-tile mdui-center mdui-shadow-5 mdui-hoverable mdui-ripple list' style='background-color: #aaa;'><img src='" + $json[i].titpiclink + "' class='mdui-center' style='height: 100%;max-height: 320px;width: auto;' /><div class='mdui-grid-tile-actions'><div class='mdui-grid-tile-text'><div class='mdui-grid-tile-title'>" + $json[i].title + "</div><div class='mdui-grid-tile-subtitle'><i class='mdui-icon material-icons'>&#xe5c3;</i>" + $json[i].cate + " , " + $json[i].time + "</div></div><div class='mdui-grid-tile-buttons'><a href='./?/" + i + "/' onclick='javascript: $Warticle(" + i + ");return false;' class='mdui-btn mdui-btn-icon'><i class='mdui-icon material-icons'>&#xe5cc;</i></a></div></div><div>";
							}
						}
                        $d.getElementById('lodingO').style.display = "none";
					}
				};
			}

			function $Rarticle($g$) {
				$ajax.abort();
				$ajax = null;
				$ajax = new XMLHttpRequest();
				if ($g$ == "About") {
					$ajax.open("GET", "./md/" + $g$ + ".md", true);
				} else {
					$ajax.open("GET", "./md/" + $json[$g$].link + ".md", true);
				}
				$ajax.send(null);
				$ajax.onreadystatechange = function() {
					if ($ajax.readyState == 4 && $ajax.status == 200) {
                        history.pushState(null, null, "/?/" + $g$ + "/");
                        $d.getElementById('articlelist').innerHTML = "";
				        $d.getElementById('articlelist').innerHTML += "<div class='mdui-shadow-5 mdui-center artivalue'><center><h1 id='tit'></h1></center><p style='color: #999;font-size: 0.9em;'><span id='cat'>分类：</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='tim'>时间：</span></p><div class='mdui-divider'></div><br><article class='mdvle' style='width: 100%;height: 100%;' id='artvle'></article></div>";
                        if($g$ != "About"){
                            $d.getElementById('tit').innerHTML = $json[$g$].title;
                            $d.getElementById('cat').innerHTML += $json[$g$].cate;
                            $d.getElementById('tim').innerHTML += $json[$g$].time;
                        } else {
                            $d.getElementById('tit').innerHTML = $g$;
                            $d.getElementById('cat').innerHTML += "ADMIN";
                            $d.getElementById('tim').innerHTML += "2020-06-28";
                        }
                        $d.getElementById('artvle').innerHTML += marked($ajax.responseText);
                        $d.getElementById('lodingO').style.display = "none";
					}
				};
			}

			function $Warticle($g$) {
                $d.getElementById('lodingO').style.display = "block";
				$ajax.open("GET", "article.json", true);
				$ajax.send(null);
				$ajax.onreadystatechange = function() {
					if ($ajax.readyState == 4 && $ajax.status == 200) {
						$json = JSON.parse($ajax.responseText);
						$Rarticle($g$);
					}
				};
			}

			switch($get) {
				case null:
					$index();
					break;
				default:
					$Warticle($get);
			}

			if (date.getHours() >= 21 || date.getHours() <= 7) {
				$d.getElementById('body').className += " mdui-theme-layout-dark";
				$d.getElementById('left-drawer').className += " mdui-color-theme";
				$d.getElementById('ft').className += " mdui-color-grey-900";
				$d.getElementById('artvle').className += " mdui-color-grey-800";
			} else {
				$d.getElementById('body').className += " mdui-theme-primary-blue";
				$d.getElementById('left-drawer').className += " mdui-color-white";
				$d.getElementById('ft').className += " mdui-color-grey-200";
				$d.getElementById('artvle').className += " mdui-color-grey-100"
			}

            window.onload = function(){
                $d.getElementById('artvle').className = "mdvle";
            }
		</script>

	</body>
</html>